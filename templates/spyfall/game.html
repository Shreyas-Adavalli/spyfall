<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">

    <title>Spyfall</title>

<body>

    <!-- Main container -->
    <div class="container" id="game" data-timer="{{ timer }}">

        <h1 class="title">All Roles Assigned</h1>

        <!-- Timer box -->
        <div class="timer-box">
            <p class="timer-label">Round Timer</p>
            <p class="timer-value" id="timerDisplay">{{ timer }}:00</p>
        </div>

        <button id="startBtn" class="start-btn">Start Timer</button>
        <button id="pauseBtn" class="start-btn" style="display:none;">Pause</button>

        <!-- Locations section -->
        <h2 class="subtitle">Possible Locations</h2>

        <ul class="locations-grid">
            {% for loc in locations %}
                <li class="location-item">{{ loc }}</li>
            {% endfor %}
        </ul>

        <!-- New game button -->
        <form action="/spyfall" method="get" class="new-game-form">
            <button type="submit" class="new-game-btn">
                New Game
            </button>
        </form>

         <!-- Home -->
        <form action="/" method="get" class="new-game-form">
            <button type="submit" class="new-game-btn">
                Back to Home
            </button>
        </form>
        <a href="/" class="new-game-btn" style="text-decoration:none; text-align:center;">
            Back to Home
        </a>

    </div>

    <!-- Timer Script -->
    <script>
        (function () {
            const gameEl = document.getElementById('game');
            const minutes = Number(gameEl.dataset.timer) || 3;
            let timeLeft = minutes * 60;

            const timerDisplay = document.getElementById('timerDisplay');
            const startBtn = document.getElementById('startBtn');
            const pauseBtn = document.getElementById('pauseBtn');

            let intervalId = null;
            let running = false;

            function formatTime(sec) {
                const m = Math.floor(sec / 60);
                const s = sec % 60;
                return m + ':' + (s < 10 ? '0' + s : s);
            }

            timerDisplay.textContent = formatTime(timeLeft);

            function startTimer() {
                if (running) return;
                running = true;
                startBtn.disabled = true;
                pauseBtn.style.display = "block";

                intervalId = setInterval(() => {
                    timeLeft--;
                    if (timeLeft < 0) {
                        clearInterval(intervalId);
                        timerDisplay.textContent = "Time's up!";
                        return;
                    }
                    timerDisplay.textContent = formatTime(timeLeft);
                }, 1000);
            }

            function togglePause() {
                if (!running) return;

                if (intervalId) {
                    clearInterval(intervalId);
                    intervalId = null;
                    pauseBtn.textContent = "Continue";
                } else {
                    intervalId = setInterval(() => {
                        timeLeft--;
                        if (timeLeft < 0) {
                            clearInterval(intervalId);
                            timerDisplay.textContent = "Time's up!";
                            return;
                        }
                        timerDisplay.textContent = formatTime(timeLeft);
                    }, 1000);
                    pauseBtn.textContent = "Pause";
                }
            }

            startBtn.addEventListener('click', startTimer);
            pauseBtn.addEventListener('click', togglePause);
        })();
    </script>

</body>
</html>
